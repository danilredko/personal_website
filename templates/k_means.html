
{% extends 'base.html' %}
{% load static %}

{% block title %} K Means {% endblock %}

{% block content %}


<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>




<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>

  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
    <h1><center><br><strong>Hierarchical K Means Visualization </strong><br></h1>
<br>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">MiniBatchKMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets.samples_generator</span> <span class="k">import</span> <span class="n">make_blobs</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="k">import</span> <span class="n">euclidean</span> <span class="k">as</span> <span class="n">euc</span>
<span class="o">%</span><span class="k">matplotlib</span> notebook
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<br>
<h4 id="I've-decided-to-make-a-visualization-of-the-K---Means-clustering.-We'll-store-all-the-centers-of-clusters-in-a-tree-structure.-So-we-need-to-make-a-Node-class-to-store-the-values.-Simple-class-where-Node-will-have-a-value-and-its-children.">I've decided to make a visualization of the K - Means clustering. We'll store all the centers of clusters in a tree structure. So we need to make a Node class to store the values. Simple class where Node will have a value and its children: </h4>
</div>
<br>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<br>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Recurvise-algorithm-to-count-the-number-of-nodes-in-the-tree(not-including-the-root).">Recurvise algorithm to count the number of nodes in the tree(not including the root): </h4>
</div>
<br>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>

    <span class="c1">#Set a counter </span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1">#Set a condition where a recursion needs to return a value,</span>
    <span class="c1">#In our case when a tree has no children we return the counter</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        
        <span class="c1">#We go over each child in the tree and call the algorithm on children</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            
            <span class="c1">#Counter contains of the number of nodes a child has and + 1 for itself. </span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">counter</span>
</pre></div>

    </div>
</div>
</div>
<br>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-following-code-constucts-the-tree-for-2d-data.">The following code constucts the tree for 2d data: </h4>
</div>
<br>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">construct2d_tree</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="n">number_of_clusters</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span>  <span class="n">model</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>

    <span class="c1">#Create a tree by setting the value </span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>

    <span class="c1">#While maximum depth is not reached continue clustering </span>
    <span class="k">if</span> <span class="n">max_depth</span> <span class="o">&gt;</span> <span class="n">depth</span><span class="p">:</span>
        
        <span class="c1">#Fit the model given using the cluster</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
        <span class="c1">#Get centers of the clusters</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cluster_centers_</span>
        <span class="c1">#Get the labels of the clusters</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">labels_</span>
        
        <span class="c1">#Now for each cluster repeat the following:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_clusters</span><span class="p">):</span>

            <span class="c1">#By using labels, get the data for specific cluster</span>
            <span class="n">new_cluster</span> <span class="o">=</span> <span class="n">cluster</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>
            
            <span class="c1">#Call the same algorithm on the cluster we got above</span>
            <span class="n">child</span><span class="p">,</span> <span class="n">data_child</span> <span class="o">=</span> <span class="n">construct2d_tree</span><span class="p">(</span><span class="n">new_cluster</span><span class="p">,</span> <span class="n">number_of_clusters</span><span class="p">,</span> 
                                                 <span class="n">centers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="n">model</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="c1">#Add the clusters and the new centers to the tree</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">data_child</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tree</span><span class="p">,</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<br>
<h4 id="The-function-plots-the-scatter-plot-for-different-branch-factors-where-each-cluster-has-its-own-color.">The function plots the scatter plot for different branch factors where each cluster has its own color: </h4>
</div>
<br>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_plot</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">):</span>
    
    <span class="c1"># By layer, I mean the level of the tree. </span>

    <span class="n">layers_tree</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">layers_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Adding first childen to the lists for data, and for tree with cluster centers </span>
    <span class="n">layers_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
    <span class="n">layers_tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
    
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_depth</span><span class="p">):</span>
        
        <span class="c1">#get a list of the nodes at each level and append it to the list </span>
        <span class="c1">#containing all layers(levels)</span>
        <span class="n">layer_tree_item</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">layers_tree</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">children</span> 
                                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_tree</span><span class="p">[</span><span class="n">level</span><span class="p">]))])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">layers_tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_tree_item</span><span class="p">)</span>
        <span class="n">layer_data_item</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">layers_data</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">children</span> 
                                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_data</span><span class="p">[</span><span class="n">level</span><span class="p">]))])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">layers_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_data_item</span><span class="p">)</span>
    
    <span class="c1">#First plot the first cluster with no K-means algorithm amain_pagepplied</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Iteration: 0 </span><span class="se">\n</span><span class="s1"> Branch Factor: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">branch_factor</span><span class="p">))</span>

    <span class="c1"># Now go over each level of the tree, and plot the clusters for each branch factor </span>
    <span class="k">for</span> <span class="n">num_layers</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_depth</span><span class="p">):</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#Plot the data using different colors to visualize the clusters </span>
        <span class="k">for</span> <span class="n">data_item</span><span class="p">,</span> <span class="n">tree_item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">layers_data</span><span class="p">[</span><span class="n">num_layers</span><span class="p">],</span>
                                        <span class="n">layers_tree</span><span class="p">[</span><span class="n">num_layers</span><span class="p">]):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Iteration: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> Branch Factor: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span>
                      <span class="nb">format</span><span class="p">(</span><span class="n">num_layers</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_item</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">data_item</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
            <span class="c1"># Plot clusters&#39; centers as well</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tree_item</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree_item</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Hierarchical K-Means for 2D&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<br>
<h4 id="Now-we-can-set-up-a-model,-and-then-graph-the-results:">Now we can set up a model, and then graph the results: </h4>
<br>
</div>
</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now we can set up a model, and then graph the results: </span>

<span class="n">branch_factor</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">max_depth</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1">#Get random points</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Get a center of the cluster when all the data used</span>
<span class="n">first_center</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">cluster_centers_</span>

<span class="c1"># Define model that will be used for constructing 2D tree</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">branch_factor</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">tree</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">construct2d_tree</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">,</span>  <span class="n">first_center</span><span class="p">,</span>  <span class="n">model</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">number_of_nodes</span> <span class="o">=</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="c1">#Get the number of nodes in the tree</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tree has </span><span class="si">{}</span><span class="s1"> nodes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_nodes</span><span class="p">))</span>
<span class="c1">#Plot the results </span>
<span class="n">my_plot</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">

<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Tree has 39 nodes
</pre>
</div>
</div>





</div>
</div>

</div>
        <div class="container">

            <img src="../../static/images/k_means_graph.png" style="width:100%">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now we can set up a model, and then graph the results: </span>

<span class="n">branch_factor</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">max_depth</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1">#Get random points</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Get a center of the cluster when all the data used</span>
<span class="n">first_center</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">cluster_centers_</span>

<span class="c1"># Define model that will be used for constructing 2D tree</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">branch_factor</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">tree</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">construct2d_tree</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">,</span>  <span class="n">first_center</span><span class="p">,</span>  <span class="n">model</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">number_of_nodes</span> <span class="o">=</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="c1">#Get the number of nodes in the tree</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tree has </span><span class="si">{}</span><span class="s1"> nodes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_nodes</span><span class="p">))</span>
<span class="c1">#Plot the results </span>
<span class="n">my_plot</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">branch_factor</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>


<div class="output_wrapper">

<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Tree has 84 nodes
</pre>
</div>
</div>

</div>
        <div class="container">

            <img src="../../static/images/k_means_graph_branch4.png" style="width:100%">

</div>



</div>
</div>

</div>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</body>

{% endblock %}



